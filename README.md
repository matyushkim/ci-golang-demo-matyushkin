# CI Golang-Demo

> Демо-приложение, для учебных целей по практике настройки пайплайнов для Github Actions и GitlabCI 

## Перед началом

- для решения задач на Github Actions: сделайте форк этого репозитория к себе в аккаунт
- для решения задач на Gitlab CI: создайте новый проект, нажав "New Project" и выберите "Import project"; в предложенных вариантах выберите `Repository by URL` и укажите этот репозиторий как источник для импорта

Ознакомиться с примерами запуска пайплайнов:

Github Actions - [Building and testing Go](https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-go)
GitlabCI - [Use CI/CD to build your application](https://docs.gitlab.com/ee/topics/build_your_application.html)

## Обзор

Все команды запуска задач в проекте объедены в Makefile. Вот какие действия можно совершать:

- `make dep` - проверка и получение зависимостей приложения
- `make lint` - проверка кода на наличие ошибок
- `make test` - запуск тестов приложения
- `make build` - запуск сборки приложения

## Задания

### Задание 1

При каждой отправке кода в `main` ветку репозитория должны запускаться:
- проверка кода на ошибки
- запуск тестов приложения

### Задание 2

Добавить шаг сборки приложения только при успешном завершении задач из `Задания 1`

> Приложение должно собираться с помощью `make build`

### Задание 3

Перевести сборку приложения в Docker

- Написать простой Dockerfile для сборки приложения
- Запустить сборку приложения на базе Docker

> :bulb: Для создания Dockerfile можно обратиться к примерам из статьи https://habr.com/ru/companies/otus/articles/660301/

### Задание 4

Расширяем задание 3 следующими задачами:

- Запускать сборку докер-образа только при наличии тэга коммита, тэги имеют формат SemVer
- Название тэга образа должно строиться из следующих значений: `<название ветки>-<sha-коммита>`, второй тэг должен совпадать с именем тэга (например `1.2.3`)
- Загрузить готовый docker-образ в репозиторий (в соотвествующий репозиторий текущего CI-сервиса)

> :bulb: Перед выполнением задания ознакомиться с форматом SemVer по ссылке: https://semver.org/lang/ru/